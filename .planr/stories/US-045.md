# US-045: Migrate Database from PostgreSQL to SQLite

**Como** desarrollador del sistema,
**quiero** migrar la base de datos de PostgreSQL a SQLite
**para** simplificar el setup de desarrollo y reducir dependencias externas.

## Criterios de aceptaci√≥n
- [ ] La configuraci√≥n de base de datos se actualiza para usar SQLite.
- [ ] Se elimina la dependencia de PostgreSQL en el entorno de desarrollo.
- [ ] El sistema funciona correctamente con SQLite sin p√©rdida de funcionalidad.
- [ ] Los datos existentes se migran o se recrean seg√∫n sea necesario.

## Notas de implementaci√≥n
- Actualizar el archivo .env para establecer DATABASE_CLIENT=sqlite.
- Remover variables de entorno espec√≠ficas de PostgreSQL.
- Asegurar que el path del archivo SQLite sea apropiado.
- Probar la aplicaci√≥n con la nueva configuraci√≥n.

## Developer Notes

### [2025-09-24] Planificaci√≥n de migraci√≥n

**Arquitectura del sistema:**
```
ENV CONFIG ‚Üí STRAPI CONFIG ‚Üí SQLITE DB ‚Üí MIGRACI√ìN DATOS
```

**Componentes a modificar:**
- **Configuraci√≥n de base de datos:** Actualizar database.ts y .env
- **Variables de entorno:** Remover PostgreSQL vars

**Archivos a modificar:**
- `backend/prana-market-backend/.env` - Agregar DATABASE_CLIENT=sqlite
- `backend/prana-market-backend/config/database.ts` - Ya soporta SQLite

**Flujo de trabajo:**
1. Actualizar configuraci√≥n de entorno
2. Detener servidor Strapi
3. Respaldar datos de PostgreSQL si es necesario
4. Ejecutar Strapi para inicializar SQLite
5. Probar funcionalidad completa

**Consideraciones de rendimiento:**
- SQLite es adecuado para desarrollo pero no para producci√≥n de alto tr√°fico
- El archivo .db debe estar en .tmp/data.db por defecto
- Migraci√≥n de datos requiere scripts manuales si hay datos importantes

### [2025-09-24] Implementaci√≥n pendiente

**Cambios requeridos:**
- ‚úÖ Confirmar configuraci√≥n actual (PostgreSQL)
- üîÑ Crear/actualizar .env con DATABASE_CLIENT=sqlite
- ‚è≥ Remover variables PostgreSQL espec√≠ficas
- ‚è≥ Verificar path del archivo SQLite
- ‚è≥ Respaldar datos existentes si necesario
- ‚è≥ Detener servidor Strapi
- ‚è≥ Ejecutar build y develop para inicializar SQLite
- ‚è≥ Probar aplicaci√≥n
- ‚è≥ Actualizar documentaci√≥n

**Estructura de configuraci√≥n:**
```env
# Antes (PostgreSQL)
DATABASE_CLIENT=postgres
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=strapi
DATABASE_USERNAME=strapi
DATABASE_PASSWORD=strapi

# Despu√©s (SQLite)
DATABASE_CLIENT=sqlite
# Otras vars removidas
```

**Validaciones implementadas:**
- Verificar que Strapi inicia correctamente con SQLite
- Probar operaciones CRUD b√°sicas
- Asegurar compatibilidad con esquemas existentes

**Testing recomendado:**
- ‚úÖ Verificar importaci√≥n sin errores
- ‚è≥ Probar endpoints existentes
- ‚è≥ Compatible con arquitectura actual

**Pr√≥ximos pasos recomendados:**
- Implementar scripts de migraci√≥n si se requieren datos hist√≥ricos
- Considerar backup autom√°tico antes de cambios
- Documentar proceso para futuros desarrollos